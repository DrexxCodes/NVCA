<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>N.V.C.A - Auth</title>
    <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/jpg" href="hero.jpg" />
    <meta name="description"
    content="Welcome to the NAPSS, UNIZIK Chapter viewers choice award voting portal. Cast your vote for your favorite best dressed person and they may stand chance of winning 20K! Developed by Drexx Codes, Powered by Spotix Nigeria" />
  <style>
    /* General Reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: radial-gradient(circle at 20% 80%, rgba(30, 30, 30, 0.8) 0%, transparent 50%),
                  radial-gradient(circle at 80% 20%, rgba(50, 50, 50, 0.6) 0%, transparent 50%),
                  linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
      color: #c0c0c0;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }

    /* Glassmorphic Header */
    header {
      padding: 25px;
      font-size: 2rem;
      font-weight: bold;
      letter-spacing: 3px;
      background: rgba(17, 17, 17, 0.7);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border-bottom: 1px solid rgba(192, 192, 192, 0.3);
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
      text-align: center;
    }

    /* Main Container */
    .main-container {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
    }

    /* Auth Container */
    .auth-container {
      background: rgba(17, 17, 17, 0.8);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(192, 192, 192, 0.3);
      border-radius: 25px;
      padding: 50px;
      width: 100%;
      max-width: 450px;
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.5),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }

    .auth-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, #c0c0c0, transparent);
      animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    /* Form Tabs */
    .tab-container {
      display: flex;
      margin-bottom: 30px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      padding: 5px;
      border: 1px solid rgba(192, 192, 192, 0.2);
    }

    .tab-btn {
      flex: 1;
      padding: 15px;
      background: transparent;
      border: none;
      color: #c0c0c0;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .tab-btn.active {
      background: rgba(192, 192, 192, 0.2);
      color: #ffffff;
      box-shadow: 0 4px 15px rgba(192, 192, 192, 0.2);
    }

    .tab-btn:hover {
      background: rgba(192, 192, 192, 0.1);
      color: #ffffff;
    }

    /* Form Styles */
    .form-container {
      position: relative;
    }

    .auth-form {
      display: none;
    }

    .auth-form.active {
      display: block;
      animation: fadeInForm 0.5s ease forwards;
    }

    @keyframes fadeInForm {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .form-group {
      margin-bottom: 25px;
      position: relative;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #e0e0e0;
      font-weight: 500;
      font-size: 0.95rem;
    }

    .form-group input {
      width: 100%;
      padding: 15px 20px;
      background: rgba(30, 30, 30, 0.6);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(192, 192, 192, 0.3);
      border-radius: 12px;
      color: #ffffff;
      font-size: 1rem;
      transition: all 0.3s ease;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .form-group input:focus {
      outline: none;
      border-color: rgba(192, 192, 192, 0.6);
      box-shadow: 
        inset 0 2px 4px rgba(0, 0, 0, 0.3),
        0 0 20px rgba(192, 192, 192, 0.2);
      background: rgba(30, 30, 30, 0.8);
    }

    .form-group input::placeholder {
      color: #888;
    }

    /* Submit Button */
    .submit-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(45deg, #c0c0c0, #ffffff, #c0c0c0);
      color: #000;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 20px rgba(192, 192, 192, 0.3);
    }

    .submit-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.5s;
    }

    .submit-btn:hover::before {
      left: 100%;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(192, 192, 192, 0.4);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Loading Spinner */
    .loading {
      display: none;
      margin: 20px auto;
      width: 40px;
      height: 40px;
      border: 3px solid rgba(192, 192, 192, 0.3);
      border-top: 3px solid #c0c0c0;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Error/Success Messages */
    .message {
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-weight: 500;
      display: none;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .message.error {
      background: rgba(220, 53, 69, 0.2);
      border: 1px solid rgba(220, 53, 69, 0.5);
      color: #ff6b6b;
    }

    .message.success {
      background: rgba(40, 167, 69, 0.2);
      border: 1px solid rgba(40, 167, 69, 0.5);
      color: #4ade80;
    }

    /* Enhanced Footer */
    footer {
      padding: 30px;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border-top: 1px solid rgba(192, 192, 192, 0.3);
      box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.3);
      text-align: center;
    }

    footer a {
      color: #c0c0c0;
      text-decoration: none;
      font-weight: bold;
      transition: all 0.3s ease;
      position: relative;
    }

    footer a::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(45deg, #c0c0c0, #ffffff);
      transition: width 0.3s ease;
    }

    footer a:hover::after {
      width: 100%;
    }

    /* Back to Home Link */
    .back-link {
      position: absolute;
      top: 20px;
      left: 20px;
      color: #c0c0c0;
      text-decoration: none;
      font-weight: 500;
      padding: 10px 20px;
      background: rgba(17, 17, 17, 0.7);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(192, 192, 192, 0.3);
      border-radius: 25px;
      transition: all 0.3s ease;
    }

    .back-link:hover {
      background: rgba(30, 30, 30, 0.8);
      transform: translateX(-5px);
    }

    /* Preloader Styles */
    .preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .preloader-left, .preloader-right {
      position: absolute;
      top: 0;
      width: 50%;
      height: 100%;
      background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #2a2a2a 100%);
      transition: transform 1.5s cubic-bezier(0.77, 0, 0.175, 1);
      z-index: 10000;
    }

    .preloader-left {
      left: 0;
    }

    .preloader-right {
      right: 0;
    }

    .preloader.curtain-open .preloader-left {
      transform: translateX(-100%);
    }

    .preloader.curtain-open .preloader-right {
      transform: translateX(100%);
    }

    .preloader-content {
      text-align: center;
      animation: fadeInUp 1.5s ease forwards;
      z-index: 10001;
      position: relative;
    }

    .preloader h1 {
      font-size: 3.5rem;
      font-weight: bold;
      background: linear-gradient(45deg, #ffd700, #ffffff, #ffd700);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 20px;
      letter-spacing: 2px;
      animation: titleGlow 2s ease-in-out infinite alternate;
    }

    .preloader p {
      font-size: 1.3rem;
      color: #c0c0c0;
      font-style: italic;
      margin-bottom: 40px;
      opacity: 0.9;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(255, 215, 0, 0.3);
      border-top: 4px solid #ffd700;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    .preloader-credits {
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.9rem;
      color: #888;
      z-index: 10001;
      animation: fadeInUp 2s ease forwards;
      animation-delay: 1s;
      opacity: 0;
    }

    .preloader-credits a {
      color: #ffd700;
      text-decoration: none;
      font-weight: bold;
    }

    .preloader-credits a:hover {
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.8);
    }

    @keyframes titleGlow {
      from { filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.5)); }
      to { filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8)); }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Main Content Wrapper */
    .main-content {
      opacity: 0;
      transition: opacity 1s ease;
      transition-delay: 0.5s;
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .main-content.visible {
      opacity: 1;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      /* Responsive styles for preloader */
      .preloader h1 { font-size: 2.5rem; }
      .preloader p { font-size: 1.1rem; }
      .preloader-credits { font-size: 0.8rem; bottom: 20px; }

      .auth-container {
        margin: 20px;
        padding: 30px;
      }

      .back-link {
        position: static;
        display: inline-block;
        margin-bottom: 20px;
      }

      header {
        padding: 20px;
        font-size: 1.5rem;
      }
    }
  </style>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
    import { getFirestore, doc, setDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    // Firebase configuration (Replace with your config)
    const firebaseConfig = {
      apiKey: "AIzaSyBnA5VAidJ20mtaoikC4p0oJyq6Ji2h-qU",
      authDomain: "coding-squad-249f7.firebaseapp.com",
      databaseURL: "https://coding-squad-249f7-default-rtdb.firebaseio.com",
      projectId: "coding-squad-249f7",
      storageBucket: "coding-squad-249f7.appspot.com",
      messagingSenderId: "385893863935",
      appId: "1:385893863935:web:e7b73f4deb14eef6d197ca"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Global variables
    window.auth = auth;
    window.db = db;
    window.setDoc = setDoc;
    window.doc = doc;
    window.serverTimestamp = serverTimestamp;
    window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
    window.signInWithEmailAndPassword = signInWithEmailAndPassword;
    window.onAuthStateChanged = onAuthStateChanged;
  </script>
</head>
<body>
  <!-- Preloader with curtain animation and credits -->
  <div class="preloader" id="preloader">
    <div class="preloader-left"></div>
    <div class="preloader-right"></div>
    <div class="preloader-content">
      <h1>Welcome to NVCA Portal</h1>
      <p>Doing ordinary things extraordinarily</p>
      <div class="loading-spinner"></div>
    </div>
    <div class="preloader-credits">
      Powered by <a href="#" target="_blank">Spotix Nigeria</a>, Developed by <a href="https://drexx.vercel.app" target="_blank">Drexx Codes</a>
    </div>
  </div>

  <!-- Wrapped existing content in main-content div -->
  <div class="main-content" id="mainContent">
    <!-- Back to Home Link -->
    <a href="index.html" class="back-link fade-in">← Back to Home</a>

    <!-- Header -->
    <header class="fade-in">
      <h1>N.V.C.A Authentication</h1>
    </header>

    <!-- Main Container -->
    <div class="main-container">
      <div class="auth-container slide-up">
        <!-- Tab Container -->
        <div class="tab-container">
          <button class="tab-btn active" onclick="switchTab('login')">Login</button>
          <button class="tab-btn" onclick="switchTab('signup')">Sign Up</button>
        </div>

        <!-- Messages -->
        <div id="message" class="message"></div>
        <div id="loading" class="loading"></div>

        <!-- Login Form -->
        <div id="loginForm" class="auth-form active">
          <form onsubmit="handleLogin(event)">
            <div class="form-group">
              <label for="loginEmail">Email Address</label>
              <input type="email" id="loginEmail" placeholder="Enter your email" required>
            </div>

            <div class="form-group">
              <label for="loginPassword">Password</label>
              <input type="password" id="loginPassword" placeholder="Enter your password" required>
            </div>

            <button type="submit" class="submit-btn">Login to Vote</button>
          </form>
        </div>

        <!-- Signup Form -->
        <div id="signupForm" class="auth-form">
          <form onsubmit="handleSignup(event)">
            <div class="form-group">
              <label for="signupUsername">Username</label>
              <input type="text" id="signupUsername" placeholder="Choose a username" required>
            </div>

            <div class="form-group">
              <label for="signupEmail">Email Address</label>
              <input type="email" id="signupEmail" placeholder="Enter your email" required>
            </div>

            <div class="form-group">
              <label for="signupPassword">Password</label>
              <input type="password" id="signupPassword" placeholder="Create a password" required minlength="6">
            </div>

            <div class="form-group">
              <label for="confirmPassword">Confirm Password</label>
              <input type="password" id="confirmPassword" placeholder="Confirm your password" required>
            </div>

            <button type="submit" class="submit-btn">Create Account</button>
          </form>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="fade-in">
      <p>Developed by <a href="https://drexx.vercel.app" target="_blank">Drexx Codes</a></p>
    </footer>
  </div>

  <script>
    // Tab switching functionality
    function switchTab(tab) {
      const loginForm = document.getElementById('loginForm');
      const signupForm = document.getElementById('signupForm');
      const tabBtns = document.querySelectorAll('.tab-btn');
      const messageEl = document.getElementById('message');

      // Hide message when switching tabs
      hideMessage();

      // Reset tab buttons
      tabBtns.forEach(btn => btn.classList.remove('active'));

      if (tab === 'login') {
        loginForm.classList.add('active');
        signupForm.classList.remove('active');
        tabBtns[0].classList.add('active');
      } else {
        signupForm.classList.add('active');
        loginForm.classList.remove('active');
        tabBtns[1].classList.add('active');
      }
    }

    // Show/Hide loading
    function showLoading() {
      document.getElementById('loading').style.display = 'block';
      document.querySelectorAll('.submit-btn').forEach(btn => btn.disabled = true);
    }

    function hideLoading() {
      document.getElementById('loading').style.display = 'none';
      document.querySelectorAll('.submit-btn').forEach(btn => btn.disabled = false);
    }

    // Show messages
    function showMessage(text, type) {
      const messageEl = document.getElementById('message');
      messageEl.textContent = text;
      messageEl.className = `message ${type}`;
      messageEl.style.display = 'block';

      // Auto-hide success messages
      if (type === 'success') {
        setTimeout(() => hideMessage(), 3000);
      }
    }

    function hideMessage() {
      const messageEl = document.getElementById('message');
      messageEl.style.display = 'none';
    }

    // Handle Login
    async function handleLogin(event) {
      event.preventDefault();

      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      showLoading();
      hideMessage();

      try {
        const userCredential = await window.signInWithEmailAndPassword(window.auth, email, password);
        showMessage('Login successful! Redirecting...', 'success');

        // Redirect to voting page after successful login
        setTimeout(() => {
          window.location.href = 'vote.html';
        }, 2000);

      } catch (error) {
        console.error('Login error:', error);
        let errorMessage = 'Login failed. Please try again.';

        switch (error.code) {
          case 'auth/user-not-found':
            errorMessage = 'No account found with this email.';
            break;
          case 'auth/wrong-password':
            errorMessage = 'Incorrect password.';
            break;
          case 'auth/invalid-email':
            errorMessage = 'Invalid email address.';
            break;
          case 'auth/too-many-requests':
            errorMessage = 'Too many failed attempts. Try again later.';
            break;
        }

        showMessage(errorMessage, 'error');
      } finally {
        hideLoading();
      }
    }

    // Handle Signup
    async function handleSignup(event) {
      event.preventDefault();

      const username = document.getElementById('signupUsername').value.trim();
      const email = document.getElementById('signupEmail').value;
      const password = document.getElementById('signupPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;

      // Validation
      if (username.length < 3) {
        showMessage('Username must be at least 3 characters long.', 'error');
        return;
      }

      if (password !== confirmPassword) {
        showMessage('Passwords do not match.', 'error');
        return;
      }

      if (password.length < 6) {
        showMessage('Password must be at least 6 characters long.', 'error');
        return;
      }

      showLoading();
      hideMessage();

      try {
        // Create user account
        const userCredential = await window.createUserWithEmailAndPassword(window.auth, email, password);
        const user = userCredential.user;

        // Create user document in Firestore
        const userDocRef = window.doc(window.db, 'users', user.uid);
        await window.setDoc(userDocRef, {
          username: username,
          email: email,
          userId: user.uid,
          signupDate: window.serverTimestamp(),
          role: 'user'
        });

        showMessage('Account created successfully! Redirecting...', 'success');

        // Redirect to voting page after successful signup
        setTimeout(() => {
          window.location.href = 'vote.html';
        }, 2000);

      } catch (error) {
        console.error('Signup error:', error);
        let errorMessage = 'Signup failed. Please try again.';

        switch (error.code) {
          case 'auth/email-already-in-use':
            errorMessage = 'An account with this email already exists.';
            break;
          case 'auth/invalid-email':
            errorMessage = 'Invalid email address.';
            break;
          case 'auth/weak-password':
            errorMessage = 'Password is too weak. Use at least 6 characters.';
            break;
          case 'auth/network-request-failed':
            errorMessage = 'Network error. Check your connection.';
            break;
        }

        showMessage(errorMessage, 'error');
      } finally {
        hideLoading();
      }
    }

    // Check authentication state
    window.addEventListener('load', () => {
      if (window.onAuthStateChanged) {
        window.onAuthStateChanged(window.auth, (user) => {
          if (user) {
            // User is signed in, redirect to voting page
            console.log('User already logged in:', user.email);
            // Uncomment the line below if you want to auto-redirect logged-in users
            // window.location.href = 'vote.html';
          }
        });
      }
    });

    // Form validation enhancements
    document.addEventListener('DOMContentLoaded', function() {
      // Real-time password matching for signup
      const signupPassword = document.getElementById('signupPassword');
      const confirmPassword = document.getElementById('confirmPassword');

      function validatePasswordMatch() {
        if (confirmPassword.value && signupPassword.value !== confirmPassword.value) {
          confirmPassword.style.borderColor = 'rgba(220, 53, 69, 0.6)';
        } else {
          confirmPassword.style.borderColor = 'rgba(192, 192, 192, 0.3)';
        }
      }

      if (signupPassword && confirmPassword) {
        signupPassword.addEventListener('input', validatePasswordMatch);
        confirmPassword.addEventListener('input', validatePasswordMatch);
      }

      // Username validation
      const usernameInput = document.getElementById('signupUsername');
      if (usernameInput) {
        usernameInput.addEventListener('input', function() {
          const username = this.value.trim();
          if (username.length < 3 && username.length > 0) {
            this.style.borderColor = 'rgba(220, 53, 69, 0.6)';
          } else {
            this.style.borderColor = 'rgba(192, 192, 192, 0.3)';
          }
        });
      }
    });

    // Preloader functionality with curtain animation
    window.addEventListener('load', function() {
      setTimeout(function() {
        document.getElementById('preloader').classList.add('curtain-open');

        setTimeout(function() {
          document.getElementById('preloader').style.display = 'none';
          document.getElementById('mainContent').classList.add('visible');
        }, 1500);
      }, 3000);
    });
  </script>
</body>
</html>